# エクスポート機能 導入ガイド

このガイドでは、MirrorShardのエクスポート機能を利用するために必要な、外部ツールの導入と設定方法について詳しく説明します。

## 1. 概要

MirrorShardは、オープンソースの強力な文書変換ツール**Pandoc**と連携することで、あなたの書いたテキストを
・EPUB形式の電子書籍
・HTML形式
・PDF形式
に変換することができます。
日本語の縦書きや、青空文庫形式のルビにも対応しています。

ただし、この機能を利用するにはPandocのインストールが必要になります。以下の手順に従ってインストールしてください。

## 2. Pandocの導入

### a) ダウンロードとインストール

Pandocは、ほぼすべてのテキストフォーマットを相互に変換できる便利なツールです。

1.  **インストーラーをダウンロード**:
    以下の公式サイトのリリースページから、「Download the latest installer」ボタンを押して移動し、Assetsの欄からお使いのOSに合ったインストーラーをダウンロードしてください。
    *   **[Pandoc - Installing](https://pandoc.org/installing.html)**
    *   **Windows**: `.msi`という拡張子のファイルがインストーラーです。
    *   **macOS**: `.pkg`という拡張子のファイルがインストーラーです。
    *   **Linux**: お使いのディストリビューションのパッケージマネージャ（apt, dnf, pacmanなど）ではなく、公式サイトで最新のPandocを入手してください。Pandocのバージョンが古いと、エクスポートが正常に機能しません。
    たとえばdebの場合、debパッケージをダウンロードして
sudo dpkg -i $DEB（※$DEBはdebのパス）
　とすればインストールできます。詳しくは公式サイトを御覧ください。

2.  **インストーラーを実行**:
    ダウンロードしたインストーラーの指示に従って、インストールを完了してください。通常、これによりPandocがシステムに自動的に認識されるようになります。

### b) MirrorShardでのパス設定

通常、Pandocは自動で認識されますが、もしエクスポート機能が「Pandocが見つかりません」というエラーを出す場合は、以下の手順でパスを手動で設定してください。

1.  MirrorShardで`F2`キーを押し、「高度な設定」ウィンドウを開きます。
2.  「Pandoc Path」の項目の「Select...」ボタンをクリックします。
3.  Pandocの実行ファイルを選択します。一般的なインストール場所は以下の通りです。
    *   **Windows**: `C:\Program Files\Pandoc\pandoc.exe`
      （ローカルインストールした場合はC:\Users\ユーザー名\AppData\Local\Pandoc\pandoc.exeになります）
    *   **macOS**: `/usr/local/bin/pandoc`
        *   *macOSのファイル選択ダイアログでは、このフォルダは通常表示されません。パスを手動で入力するか、`Cmd + Shift + G`を押してパスを入力するウィンドウを開き、`/usr/local/bin/`と入力して移動してください。*
    *   **Linux**: ターミナルでwhich pandocと入力することで確認できます。通常は以下のようになります。/usr/bin/pandoc

## 3. Kindleで読むには？

生成したEPUBファイルをAmazonのサービスに送ることで、Kindleで本を読むことができます。

1.  MirrorShardで、**EPUB形式**でファイルをエクスポートします。
　※Kindleでは表紙画像が必須です。必ず指定するようにしてください。
2.  Amazonの**[Send to Kindle](https://www.amazon.co.jp/sendtokindle)**のページにアクセスし、生成されたEPUBファイルをアップロードするか、あなたのKindleに割り当てられたメールアドレス宛にEPUBファイルを添付して送信します。
3.  数分後、あなたのKindleライブラリに本が自動的に追加されます。

## 4. エクスポートの手順

1. 画面上部の「エクスポート」ボタン（またはF4キー）を押します。
2. 設定画面が開きますので、「出力形式」のプルダウンメニューからご希望の形式（EPUB・HTML・PDF）を選択します。
3. 書名・著者名など、必要事項を必要に応じて設定します。
4. 画面最下段の「Export」ボタンを押し、ファイル名と保存場所を決定して保存します。
※エクスポート画面は、画面隅の閉じるボタン、ESCキー、またはF4キーで閉じることが出来ます。

### 5. 注意事項

* PDF出力の際には、本アプリ内にあるNoto Serif JPが埋め込みフォントとして使用されます。
* 本エディタのエクスポート機能は簡易的なものです。数メガバイトあるような巨大テキストファイル、YAMLメタデータの含まれるテキストなどは正常に出力できない場合があります。あらかじめご了承ください。
* また、現バージョンでは縦中横などには未対応です。本格的な縦書き電子書籍やPDFの作成には向きませんので、あらかじめご了承ください。
